<!DOCTYPE html>
<meta charset="utf-8">
<body>

<div id='js-geojson-example'></div>

<script src='http://code.jquery.com/jquery-2.0.3.js'></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v0.min.js"></script>
<style>

  svg{
      position: absolute;
      top: 20px;
      left: 50%;
      margin-left: -500px;
  }

  .bubble {
    fill: red;
  }

  .blox {
    fill: lightgrey;
  }

</style>


<script>

  // var width  = $(window).width(),
  //     height = $(window).height();

  var width  = 1000,
      height = 1000;

  var svg = d3.select("#js-geojson-example").append("svg")
        .attr("width", width)
        .attr("height", height);

  d3.json("Data/blocks.json", function(json) {
      // create a first guess for the projection
      var center = d3.geo.centroid(json)

      var scale  = 600000;
      var offset = [width/2 + 5300, height/2 + 8640];
      var projection = d3.geo.mercator()
                        .scale(scale)
                        .center(center)
                        .translate(offset);

      // create the path
      var path = d3.geo.path().projection(projection);

      // function to scale bubble size based on data (GPS accuracy)
      var radius = d3.scale.sqrt()
        .domain([0, 12])
        .range([0, 100]);


      svg.append("path")
        .datum({type: "FeatureCollection", features: json.features})
        .attr("json", d3.geo.path())
        .attr("d", path)
        .attr("class", "blox");


        // load the car data
        d3.json("Data/car-a.json", function(carjson) {


          svg.append("g")
              .attr("class", "bubble")
            .selectAll("circle")
              .data(topojson.feature(us, us.objects.counties).features
                .sort(function(a, b) { return b.properties.population - a.properties.population; }))
            .enter().append("circle")
              .attr("r", function(d) { return radius(d.properties.population); });
          });



        //   svg.selectAll("circle")
        //     .data(carjson.features)
        //     .enter()
        //     .append("circle")
        //     .attr("d", path)
        //     .attr("r", function(d) {
        //       return radius(d.properties.accuracy);
        //     })
        //     .attr("class", "bubble")
        // });

        // add a rectangle to see the bound of the svg
        svg.append("rect").attr('width', width).attr('height', height)
          .style('stroke', 'black').style('fill', 'none');


  });

</script>

<body>

</body>
